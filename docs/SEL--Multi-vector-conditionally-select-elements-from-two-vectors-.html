<html>
 <head>  <link rel="stylesheet" href="../def-style.css"></head> 
 <body> 
  <h2>SEL</h2> 
  <p>Multi-vector conditionally select elements from two vectors</p> 
  <p>Read active elements from the two or four first source vectors and inactive elements from the two or four second source vectors and place in the corresponding elements of the two or four destination vectors.</p> 
  <p> It has encodings from 2 classes: <a class="document-topic">Two registers</a> and <a class="document-topic">Four registers</a> </p> 
  <h3><a id="iclass_to_2reg"></a>Two registers<span><br></br>(FEAT_SME2) </span></h3> 
  <div> 
   <table> 
    <thead> 
     <tr> 
      <td>31</td> 
      <td>30</td> 
      <td>29</td> 
      <td>28</td> 
      <td>27</td> 
      <td>26</td> 
      <td>25</td> 
      <td>24</td> 
      <td>23</td> 
      <td>22</td> 
      <td>21</td> 
      <td>20</td> 
      <td>19</td> 
      <td>18</td> 
      <td>17</td> 
      <td>16</td> 
      <td>15</td> 
      <td>14</td> 
      <td>13</td> 
      <td>12</td> 
      <td>11</td> 
      <td>10</td> 
      <td>9</td> 
      <td>8</td> 
      <td>7</td> 
      <td>6</td> 
      <td>5</td> 
      <td>4</td> 
      <td>3</td> 
      <td>2</td> 
      <td>1</td> 
      <td>0</td> 
     </tr> 
    </thead> 
    <tbody> 
     <tr> 
      <td>1</td> 
      <td>1</td> 
      <td>0</td> 
      <td>0</td> 
      <td>0</td> 
      <td>0</td> 
      <td>0</td> 
      <td>1</td> 
      <td colspan="2">size</td> 
      <td>1</td> 
      <td colspan="4">Zm</td> 
      <td>0</td> 
      <td>1</td> 
      <td>0</td> 
      <td>0</td> 
      <td colspan="3">PNg</td> 
      <td colspan="4">Zn</td> 
      <td>0</td> 
      <td colspan="4">Zd</td> 
      <td>0</td> 
     </tr> 
    </tbody> 
   </table> 
  </div> 
  <div> 
   <h4></h4> 
   <a id="sel_mz_p_zz_2"></a> 
   <p>SEL { <a title="First destination scalable vector register of a multi-vector sequence (field Zd)" class="document-topic">&lt;Zd1&gt;</a>.<a title="Size specifier (field &quot;size&quot;) [B,D,H,S]" class="document-topic">&lt;T&gt;</a>-<a title="Second destination scalable vector register of a multi-vector sequence (field Zd)" class="document-topic">&lt;Zd2&gt;</a>.<a title="Size specifier (field &quot;size&quot;) [B,D,H,S]" class="document-topic">&lt;T&gt;</a> }, <a title="Governing scalable predicate register PN8-PN15 (field &quot;PNg&quot;)" class="document-topic">&lt;PNg&gt;</a>, { <a title="First scalable vector register of a multi-vector sequence (field Zn)" class="document-topic">&lt;Zn1&gt;</a>.<a title="Size specifier (field &quot;size&quot;) [B,D,H,S]" class="document-topic">&lt;T&gt;</a>-<a title="Second scalable vector register of a multi-vector sequence (field Zn)" class="document-topic">&lt;Zn2&gt;</a>.<a title="Size specifier (field &quot;size&quot;) [B,D,H,S]" class="document-topic">&lt;T&gt;</a> }, { <a title="First scalable vector register of a multi-vector sequence (field Zm)" class="document-topic">&lt;Zm1&gt;</a>.<a title="Size specifier (field &quot;size&quot;) [B,D,H,S]" class="document-topic">&lt;T&gt;</a>-<a title="Second scalable vector register of a multi-vector sequence (field Zm)" class="document-topic">&lt;Zm2&gt;</a>.<a title="Size specifier (field &quot;size&quot;) [B,D,H,S]" class="document-topic">&lt;T&gt;</a> }</p> 
  </div> 
  <pre>if !<a title="function: boolean HaveSME2()" class="document-topic">HaveSME2</a>() then UNDEFINED;
constant integer esize = 8 &lt;&lt; <a title="function: integer UInt(bits(N) x)" class="document-topic">UInt</a>(size);
integer n = <a title="function: integer UInt(bits(N) x)" class="document-topic">UInt</a>(Zn:'0');
integer m = <a title="function: integer UInt(bits(N) x)" class="document-topic">UInt</a>(Zm:'0');
integer d = <a title="function: integer UInt(bits(N) x)" class="document-topic">UInt</a>(Zd:'0');
integer g = <a title="function: integer UInt(bits(N) x)" class="document-topic">UInt</a>('1':PNg);
constant integer nreg = 2;</pre> 
  <h3><a id="iclass_to_4reg"></a>Four registers<span><br></br>(FEAT_SME2) </span></h3> 
  <div> 
   <table> 
    <thead> 
     <tr> 
      <td>31</td> 
      <td>30</td> 
      <td>29</td> 
      <td>28</td> 
      <td>27</td> 
      <td>26</td> 
      <td>25</td> 
      <td>24</td> 
      <td>23</td> 
      <td>22</td> 
      <td>21</td> 
      <td>20</td> 
      <td>19</td> 
      <td>18</td> 
      <td>17</td> 
      <td>16</td> 
      <td>15</td> 
      <td>14</td> 
      <td>13</td> 
      <td>12</td> 
      <td>11</td> 
      <td>10</td> 
      <td>9</td> 
      <td>8</td> 
      <td>7</td> 
      <td>6</td> 
      <td>5</td> 
      <td>4</td> 
      <td>3</td> 
      <td>2</td> 
      <td>1</td> 
      <td>0</td> 
     </tr> 
    </thead> 
    <tbody> 
     <tr> 
      <td>1</td> 
      <td>1</td> 
      <td>0</td> 
      <td>0</td> 
      <td>0</td> 
      <td>0</td> 
      <td>0</td> 
      <td>1</td> 
      <td colspan="2">size</td> 
      <td>1</td> 
      <td colspan="3">Zm</td> 
      <td>0</td> 
      <td>1</td> 
      <td>1</td> 
      <td>0</td> 
      <td>0</td> 
      <td colspan="3">PNg</td> 
      <td colspan="3">Zn</td> 
      <td>0</td> 
      <td>0</td> 
      <td colspan="3">Zd</td> 
      <td>0</td> 
      <td>0</td> 
     </tr> 
    </tbody> 
   </table> 
  </div> 
  <div> 
   <h4></h4> 
   <a id="sel_mz_p_zz_4"></a> 
   <p>SEL { <a title="First destination scalable vector register of a multi-vector sequence (field Zd)" class="document-topic">&lt;Zd1&gt;</a>.<a title="Size specifier (field &quot;size&quot;) [B,D,H,S]" class="document-topic">&lt;T&gt;</a>-<a title="Fourth destination scalable vector register of a multi-vector sequence (field Zd)" class="document-topic">&lt;Zd4&gt;</a>.<a title="Size specifier (field &quot;size&quot;) [B,D,H,S]" class="document-topic">&lt;T&gt;</a> }, <a title="Governing scalable predicate register PN8-PN15 (field &quot;PNg&quot;)" class="document-topic">&lt;PNg&gt;</a>, { <a title="First scalable vector register of a multi-vector sequence (field Zn)" class="document-topic">&lt;Zn1&gt;</a>.<a title="Size specifier (field &quot;size&quot;) [B,D,H,S]" class="document-topic">&lt;T&gt;</a>-<a title="Fourth scalable vector register of a multi-vector sequence (field Zn)" class="document-topic">&lt;Zn4&gt;</a>.<a title="Size specifier (field &quot;size&quot;) [B,D,H,S]" class="document-topic">&lt;T&gt;</a> }, { <a title="First scalable vector register of a multi-vector sequence (field Zm)" class="document-topic">&lt;Zm1&gt;</a>.<a title="Size specifier (field &quot;size&quot;) [B,D,H,S]" class="document-topic">&lt;T&gt;</a>-<a title="Fourth scalable vector register of a multi-vector sequence (field Zm)" class="document-topic">&lt;Zm4&gt;</a>.<a title="Size specifier (field &quot;size&quot;) [B,D,H,S]" class="document-topic">&lt;T&gt;</a> }</p> 
  </div> 
  <pre>if !<a title="function: boolean HaveSME2()" class="document-topic">HaveSME2</a>() then UNDEFINED;
constant integer esize = 8 &lt;&lt; <a title="function: integer UInt(bits(N) x)" class="document-topic">UInt</a>(size);
integer n = <a title="function: integer UInt(bits(N) x)" class="document-topic">UInt</a>(Zn:'00');
integer m = <a title="function: integer UInt(bits(N) x)" class="document-topic">UInt</a>(Zm:'00');
integer d = <a title="function: integer UInt(bits(N) x)" class="document-topic">UInt</a>(Zd:'00');
integer g = <a title="function: integer UInt(bits(N) x)" class="document-topic">UInt</a>('1':PNg);
constant integer nreg = 4;</pre> 
  <div></div> 
  <h3>Assembler Symbols</h3> 
  <div> 
   <table> 
    <colgroup> 
     <col></col> 
     <col></col> 
    </colgroup> 
    <tbody> 
     <tr> 
      <td>&lt;Zd1&gt;</td> 
      <td><a id="sa_zd1"></a> <p>For the two registers variant: is the name of the first destination scalable vector register of a multi-vector sequence, encoded as "Zd" times 2.</p> </td> 
     </tr> 
     <tr> 
      <td></td> 
      <td><a id="sa_zd1_1"></a> <p>For the four registers variant: is the name of the first destination scalable vector register of a multi-vector sequence, encoded as "Zd" times 4.</p> </td> 
     </tr> 
    </tbody> 
   </table> 
   <table> 
    <colgroup> 
     <col></col> 
     <col></col> 
    </colgroup> 
    <tbody> 
     <tr> 
      <td>&lt;T&gt;</td> 
      <td><a id="sa_t"></a> <p>Is the size specifier, encoded in <q>size</q>: </p> 
       <table> 
        <thead> 
         <tr> 
          <th>size</th> 
          <th>&lt;T&gt;</th> 
         </tr> 
        </thead> 
        <tbody> 
         <tr> 
          <td>00</td> 
          <td>B</td> 
         </tr> 
         <tr> 
          <td>01</td> 
          <td>H</td> 
         </tr> 
         <tr> 
          <td>10</td> 
          <td>S</td> 
         </tr> 
         <tr> 
          <td>11</td> 
          <td>D</td> 
         </tr> 
        </tbody> 
       </table> </td> 
     </tr> 
    </tbody> 
   </table> 
   <table> 
    <colgroup> 
     <col></col> 
     <col></col> 
    </colgroup> 
    <tbody> 
     <tr> 
      <td>&lt;Zd4&gt;</td> 
      <td><a id="sa_zd4"></a> <p>Is the name of the fourth destination scalable vector register of a multi-vector sequence, encoded as "Zd" times 4 plus 3.</p> </td> 
     </tr> 
    </tbody> 
   </table> 
   <table> 
    <colgroup> 
     <col></col> 
     <col></col> 
    </colgroup> 
    <tbody> 
     <tr> 
      <td>&lt;Zd2&gt;</td> 
      <td><a id="sa_zd2"></a> <p>Is the name of the second destination scalable vector register of a multi-vector sequence, encoded as "Zd" times 2 plus 1.</p> </td> 
     </tr> 
    </tbody> 
   </table> 
   <table> 
    <colgroup> 
     <col></col> 
     <col></col> 
    </colgroup> 
    <tbody> 
     <tr> 
      <td>&lt;PNg&gt;</td> 
      <td><a id="sa_png"></a> <p>Is the name of the governing scalable predicate register PN8-PN15, with predicate-as-counter encoding, encoded in the "PNg" field.</p> </td> 
     </tr> 
    </tbody> 
   </table> 
   <table> 
    <colgroup> 
     <col></col> 
     <col></col> 
    </colgroup> 
    <tbody> 
     <tr> 
      <td>&lt;Zn1&gt;</td> 
      <td><a id="sa_zn1"></a> <p>For the two registers variant: is the name of the first scalable vector register of a multi-vector sequence, encoded as "Zn" times 2.</p> </td> 
     </tr> 
     <tr> 
      <td></td> 
      <td><a id="sa_zn1_1"></a> <p>For the four registers variant: is the name of the first scalable vector register of a multi-vector sequence, encoded as "Zn" times 4.</p> </td> 
     </tr> 
    </tbody> 
   </table> 
   <table> 
    <colgroup> 
     <col></col> 
     <col></col> 
    </colgroup> 
    <tbody> 
     <tr> 
      <td>&lt;Zn4&gt;</td> 
      <td><a id="sa_zn4"></a> <p>Is the name of the fourth scalable vector register of a multi-vector sequence, encoded as "Zn" times 4 plus 3.</p> </td> 
     </tr> 
    </tbody> 
   </table> 
   <table> 
    <colgroup> 
     <col></col> 
     <col></col> 
    </colgroup> 
    <tbody> 
     <tr> 
      <td>&lt;Zn2&gt;</td> 
      <td><a id="sa_zn2"></a> <p>Is the name of the second scalable vector register of a multi-vector sequence, encoded as "Zn" times 2 plus 1.</p> </td> 
     </tr> 
    </tbody> 
   </table> 
   <table> 
    <colgroup> 
     <col></col> 
     <col></col> 
    </colgroup> 
    <tbody> 
     <tr> 
      <td>&lt;Zm1&gt;</td> 
      <td><a id="sa_zm1"></a> <p>For the two registers variant: is the name of the first scalable vector register of a multi-vector sequence, encoded as "Zm" times 2.</p> </td> 
     </tr> 
     <tr> 
      <td></td> 
      <td><a id="sa_zm1_1"></a> <p>For the four registers variant: is the name of the first scalable vector register of a multi-vector sequence, encoded as "Zm" times 4.</p> </td> 
     </tr> 
    </tbody> 
   </table> 
   <table> 
    <colgroup> 
     <col></col> 
     <col></col> 
    </colgroup> 
    <tbody> 
     <tr> 
      <td>&lt;Zm4&gt;</td> 
      <td><a id="sa_zm4"></a> <p>Is the name of the fourth scalable vector register of a multi-vector sequence, encoded as "Zm" times 4 plus 3.</p> </td> 
     </tr> 
    </tbody> 
   </table> 
   <table> 
    <colgroup> 
     <col></col> 
     <col></col> 
    </colgroup> 
    <tbody> 
     <tr> 
      <td>&lt;Zm2&gt;</td> 
      <td><a id="sa_zm2"></a> <p>Is the name of the second scalable vector register of a multi-vector sequence, encoded as "Zm" times 2 plus 1.</p> </td> 
     </tr> 
    </tbody> 
   </table> 
  </div> 
  <div></div> 
  <div> 
   <a id="execute"></a> 
   <h3>Operation</h3> 
   <pre><a title="function: CheckStreamingSVEEnabled()" class="document-topic">CheckStreamingSVEEnabled</a>();
constant integer VL = <a title="accessor: integer CurrentVL" class="document-topic">CurrentVL</a>;
constant integer PL = VL DIV 8;
constant integer elements = VL DIV esize;
array [0..3] of bits(VL) results;
bits(PL) pred = <a title="accessor: bits(width) P[integer n, integer width]" class="document-topic">P</a>[g, PL];
bits(PL * nreg) mask = <a title="function: bits(width) CounterToPredicate(bits(16) pred, integer width)" class="document-topic">CounterToPredicate</a>(pred&lt;15:0&gt;, PL * nreg);

for r = 0 to nreg-1
    bits(VL) operand1 = <a title="accessor: bits(width) Z[integer n, integer width]" class="document-topic">Z</a>[n+r, VL];
    bits(VL) operand2 = <a title="accessor: bits(width) Z[integer n, integer width]" class="document-topic">Z</a>[m+r, VL];
    for e = 0 to elements-1
        if <a title="function: boolean ActivePredicateElement(bits(N) pred, integer e, integer esize)" class="document-topic">ActivePredicateElement</a>(mask, r * elements + e, esize) then
            <a title="accessor: Elem[bits(N) &amp;vector, integer e, integer size] = bits(size) value" class="document-topic">Elem</a>[results[r], e, esize] = <a title="accessor: bits(size) Elem[bits(N) vector, integer e, integer size]" class="document-topic">Elem</a>[operand1, e, esize];
        else
            <a title="accessor: Elem[bits(N) &amp;vector, integer e, integer size] = bits(size) value" class="document-topic">Elem</a>[results[r], e, esize] = <a title="accessor: bits(size) Elem[bits(N) vector, integer e, integer size]" class="document-topic">Elem</a>[operand2, e, esize];

for r = 0 to nreg-1
    <a title="accessor: Z[integer n, integer width] = bits(width) value" class="document-topic">Z</a>[d+r, VL] = results[r];</pre> 
  </div>  
 </body>
</html>