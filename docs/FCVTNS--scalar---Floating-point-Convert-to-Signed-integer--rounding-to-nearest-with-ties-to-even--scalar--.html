<html>
 <head>  <link rel="stylesheet" href="../def-style.css"></head> 
 <body> 
  <h2>FCVTNS (scalar)</h2> 
  <p>Floating-point Convert to Signed integer, rounding to nearest with ties to even (scalar). This instruction converts the floating-point value in the SIMD&amp;FP source register to a 32-bit or 64-bit signed integer using the Round to Nearest rounding mode, and writes the result to the general-purpose destination register.</p> 
  <p>A floating-point exception can be generated by this instruction. Depending on the settings in <em>FPCR</em>, the exception results in either a flag being set in <em>FPSR</em>, or a synchronous exception being generated. For more information, see <em>Floating-point exception traps</em>.</p> 
  <p>Depending on the settings in the <em>CPACR_EL1</em>, <em>CPTR_EL2</em>, and <em>CPTR_EL3</em> registers, and the current Security state and Exception level, an attempt to execute the instruction might be trapped.</p> 
  <p></p> 
  <div> 
   <table> 
    <thead> 
     <tr> 
      <td>31</td> 
      <td>30</td> 
      <td>29</td> 
      <td>28</td> 
      <td>27</td> 
      <td>26</td> 
      <td>25</td> 
      <td>24</td> 
      <td>23</td> 
      <td>22</td> 
      <td>21</td> 
      <td>20</td> 
      <td>19</td> 
      <td>18</td> 
      <td>17</td> 
      <td>16</td> 
      <td>15</td> 
      <td>14</td> 
      <td>13</td> 
      <td>12</td> 
      <td>11</td> 
      <td>10</td> 
      <td>9</td> 
      <td>8</td> 
      <td>7</td> 
      <td>6</td> 
      <td>5</td> 
      <td>4</td> 
      <td>3</td> 
      <td>2</td> 
      <td>1</td> 
      <td>0</td> 
     </tr> 
    </thead> 
    <tbody> 
     <tr> 
      <td>sf</td> 
      <td>0</td> 
      <td>0</td> 
      <td>1</td> 
      <td>1</td> 
      <td>1</td> 
      <td>1</td> 
      <td>0</td> 
      <td colspan="2">ftype</td> 
      <td>1</td> 
      <td>0</td> 
      <td>0</td> 
      <td>0</td> 
      <td>0</td> 
      <td>0</td> 
      <td>0</td> 
      <td>0</td> 
      <td>0</td> 
      <td>0</td> 
      <td>0</td> 
      <td>0</td> 
      <td colspan="5">Rn</td> 
      <td colspan="5">Rd</td> 
     </tr> 
     <tr> 
      <td></td> 
      <td></td> 
      <td></td> 
      <td colspan="5"></td> 
      <td colspan="2"></td> 
      <td></td> 
      <td colspan="2">rmode</td> 
      <td colspan="3">opcode</td> 
      <td colspan="6"></td> 
      <td colspan="5"></td> 
      <td colspan="5"></td> 
     </tr> 
    </tbody> 
   </table> 
  </div> 
  <div> 
   <h4>Half-precision to 32-bit<span> (sf == 0 &amp;&amp; ftype == 11)</span><span><br></br>(FEAT_FP16) </span></h4> 
   <a id="FCVTNS_32H_float2int"></a> 
   <p>FCVTNS <a title="32-bit general-purpose destination register (field &quot;Rd&quot;)" class="document-topic">&lt;Wd&gt;</a>, <a title="16-bit SIMD&amp;FP source register (field &quot;Rn&quot;)" class="document-topic">&lt;Hn&gt;</a></p> 
  </div> 
  <div> 
   <h4>Half-precision to 64-bit<span> (sf == 1 &amp;&amp; ftype == 11)</span><span><br></br>(FEAT_FP16) </span></h4> 
   <a id="FCVTNS_64H_float2int"></a> 
   <p>FCVTNS <a title="64-bit general-purpose destination register (field &quot;Rd&quot;)" class="document-topic">&lt;Xd&gt;</a>, <a title="16-bit SIMD&amp;FP source register (field &quot;Rn&quot;)" class="document-topic">&lt;Hn&gt;</a></p> 
  </div> 
  <div> 
   <h4>Single-precision to 32-bit<span> (sf == 0 &amp;&amp; ftype == 00)</span></h4> 
   <a id="FCVTNS_32S_float2int"></a> 
   <p>FCVTNS <a title="32-bit general-purpose destination register (field &quot;Rd&quot;)" class="document-topic">&lt;Wd&gt;</a>, <a title="32-bit SIMD&amp;FP source register (field &quot;Rn&quot;)" class="document-topic">&lt;Sn&gt;</a></p> 
  </div> 
  <div> 
   <h4>Single-precision to 64-bit<span> (sf == 1 &amp;&amp; ftype == 00)</span></h4> 
   <a id="FCVTNS_64S_float2int"></a> 
   <p>FCVTNS <a title="64-bit general-purpose destination register (field &quot;Rd&quot;)" class="document-topic">&lt;Xd&gt;</a>, <a title="32-bit SIMD&amp;FP source register (field &quot;Rn&quot;)" class="document-topic">&lt;Sn&gt;</a></p> 
  </div> 
  <div> 
   <h4>Double-precision to 32-bit<span> (sf == 0 &amp;&amp; ftype == 01)</span></h4> 
   <a id="FCVTNS_32D_float2int"></a> 
   <p>FCVTNS <a title="32-bit general-purpose destination register (field &quot;Rd&quot;)" class="document-topic">&lt;Wd&gt;</a>, <a title="64-bit SIMD&amp;FP source register (field &quot;Rn&quot;)" class="document-topic">&lt;Dn&gt;</a></p> 
  </div> 
  <div> 
   <h4>Double-precision to 64-bit<span> (sf == 1 &amp;&amp; ftype == 01)</span></h4> 
   <a id="FCVTNS_64D_float2int"></a> 
   <p>FCVTNS <a title="64-bit general-purpose destination register (field &quot;Rd&quot;)" class="document-topic">&lt;Xd&gt;</a>, <a title="64-bit SIMD&amp;FP source register (field &quot;Rn&quot;)" class="document-topic">&lt;Dn&gt;</a></p> 
  </div> 
  <pre>integer d = <a title="function: integer UInt(bits(N) x)" class="document-topic">UInt</a>(Rd);
integer n = <a title="function: integer UInt(bits(N) x)" class="document-topic">UInt</a>(Rn);

integer intsize = if sf == '1' then 64 else 32;
integer fltsize;
<a title="enumeration FPConvOp    {FPConvOp_CVT_FtoI, FPConvOp_CVT_ItoF, FPConvOp_MOV_FtoI, FPConvOp_MOV_ItoF , FPConvOp_CVT_FtoI_JS }" class="document-topic">FPConvOp</a> op;
<a title="enumeration FPRounding  {FPRounding_TIEEVEN, FPRounding_POSINF, FPRounding_NEGINF,  FPRounding_ZERO, FPRounding_TIEAWAY, FPRounding_ODD}" class="document-topic">FPRounding</a> rounding;
boolean unsigned;
integer part;

case ftype of
    when '00'
        fltsize = 32;
    when '01'
        fltsize = 64;
    when '10'
        if opcode&lt;2:1&gt;:rmode != '11 01' then UNDEFINED;
        fltsize = 128;
    when '11'
        if <a title="function: boolean HaveFP16Ext()" class="document-topic">HaveFP16Ext</a>() then
            fltsize = 16;
        else
            UNDEFINED;

case opcode&lt;2:1&gt;:rmode of
    when '00 xx'        // FCVT[NPMZ][US]
        rounding = <a title="function: FPRounding FPDecodeRounding(bits(2) rmode)" class="document-topic">FPDecodeRounding</a>(rmode);
        unsigned = (opcode&lt;0&gt; == '1');
        op = <a title="enumeration FPConvOp    {FPConvOp_CVT_FtoI, FPConvOp_CVT_ItoF, FPConvOp_MOV_FtoI, FPConvOp_MOV_ItoF , FPConvOp_CVT_FtoI_JS }" class="document-topic">FPConvOp_CVT_FtoI</a>;
    when '01 00'        // [US]CVTF
        rounding = <a title="function: FPRounding FPRoundingMode(FPCRType fpcr)" class="document-topic">FPRoundingMode</a>(FPCR[]);
        unsigned = (opcode&lt;0&gt; == '1');
        op = <a title="enumeration FPConvOp    {FPConvOp_CVT_FtoI, FPConvOp_CVT_ItoF, FPConvOp_MOV_FtoI, FPConvOp_MOV_ItoF , FPConvOp_CVT_FtoI_JS }" class="document-topic">FPConvOp_CVT_ItoF</a>;
    when '10 00'        // FCVTA[US]
        rounding = <a title="enumeration FPRounding  {FPRounding_TIEEVEN, FPRounding_POSINF, FPRounding_NEGINF,  FPRounding_ZERO, FPRounding_TIEAWAY, FPRounding_ODD}" class="document-topic">FPRounding_TIEAWAY</a>;
        unsigned = (opcode&lt;0&gt; == '1');
        op = <a title="enumeration FPConvOp    {FPConvOp_CVT_FtoI, FPConvOp_CVT_ItoF, FPConvOp_MOV_FtoI, FPConvOp_MOV_ItoF , FPConvOp_CVT_FtoI_JS }" class="document-topic">FPConvOp_CVT_FtoI</a>;
    when '11 00'        // FMOV
        if fltsize != 16 &amp;&amp; fltsize != intsize then UNDEFINED;
        op = if opcode&lt;0&gt; == '1' then <a title="enumeration FPConvOp    {FPConvOp_CVT_FtoI, FPConvOp_CVT_ItoF, FPConvOp_MOV_FtoI, FPConvOp_MOV_ItoF , FPConvOp_CVT_FtoI_JS }" class="document-topic">FPConvOp_MOV_ItoF</a> else <a title="enumeration FPConvOp    {FPConvOp_CVT_FtoI, FPConvOp_CVT_ItoF, FPConvOp_MOV_FtoI, FPConvOp_MOV_ItoF , FPConvOp_CVT_FtoI_JS }" class="document-topic">FPConvOp_MOV_FtoI</a>;
        part = 0;
    when '11 01'        // FMOV D[1]
        if intsize != 64 || fltsize != 128 then UNDEFINED;
        op = if opcode&lt;0&gt; == '1' then <a title="enumeration FPConvOp    {FPConvOp_CVT_FtoI, FPConvOp_CVT_ItoF, FPConvOp_MOV_FtoI, FPConvOp_MOV_ItoF , FPConvOp_CVT_FtoI_JS }" class="document-topic">FPConvOp_MOV_ItoF</a> else <a title="enumeration FPConvOp    {FPConvOp_CVT_FtoI, FPConvOp_CVT_ItoF, FPConvOp_MOV_FtoI, FPConvOp_MOV_ItoF , FPConvOp_CVT_FtoI_JS }" class="document-topic">FPConvOp_MOV_FtoI</a>;
        part = 1;
        fltsize = 64;  // size of D[1] is 64
    when '11 11'       // FJCVTZS
        if !<a title="function: boolean HaveFJCVTZSExt()" class="document-topic">HaveFJCVTZSExt</a>() then UNDEFINED;
        rounding = <a title="enumeration FPRounding  {FPRounding_TIEEVEN, FPRounding_POSINF, FPRounding_NEGINF,  FPRounding_ZERO, FPRounding_TIEAWAY, FPRounding_ODD}" class="document-topic">FPRounding_ZERO</a>;
        unsigned = (opcode&lt;0&gt; == '1');
        op = <a title="enumeration FPConvOp    {FPConvOp_CVT_FtoI, FPConvOp_CVT_ItoF, FPConvOp_MOV_FtoI, FPConvOp_MOV_ItoF , FPConvOp_CVT_FtoI_JS }" class="document-topic">FPConvOp_CVT_FtoI_JS</a>;
    otherwise
        UNDEFINED;</pre> 
  <div></div> 
  <h3>Assembler Symbols</h3> 
  <div> 
   <table> 
    <colgroup> 
     <col></col> 
     <col></col> 
    </colgroup> 
    <tbody> 
     <tr> 
      <td>&lt;Wd&gt;</td> 
      <td><a id="sa_wd"></a> <p>Is the 32-bit name of the general-purpose destination register, encoded in the "Rd" field.</p> </td> 
     </tr> 
    </tbody> 
   </table> 
   <table> 
    <colgroup> 
     <col></col> 
     <col></col> 
    </colgroup> 
    <tbody> 
     <tr> 
      <td>&lt;Xd&gt;</td> 
      <td><a id="sa_xd"></a> <p>Is the 64-bit name of the general-purpose destination register, encoded in the "Rd" field.</p> </td> 
     </tr> 
    </tbody> 
   </table> 
   <table> 
    <colgroup> 
     <col></col> 
     <col></col> 
    </colgroup> 
    <tbody> 
     <tr> 
      <td>&lt;Sn&gt;</td> 
      <td><a id="sa_sn"></a> <p>Is the 32-bit name of the SIMD&amp;FP source register, encoded in the "Rn" field.</p> </td> 
     </tr> 
    </tbody> 
   </table> 
   <table> 
    <colgroup> 
     <col></col> 
     <col></col> 
    </colgroup> 
    <tbody> 
     <tr> 
      <td>&lt;Hn&gt;</td> 
      <td><a id="sa_hn"></a> <p>Is the 16-bit name of the SIMD&amp;FP source register, encoded in the "Rn" field.</p> </td> 
     </tr> 
    </tbody> 
   </table> 
   <table> 
    <colgroup> 
     <col></col> 
     <col></col> 
    </colgroup> 
    <tbody> 
     <tr> 
      <td>&lt;Dn&gt;</td> 
      <td><a id="sa_dn"></a> <p>Is the 64-bit name of the SIMD&amp;FP source register, encoded in the "Rn" field.</p> </td> 
     </tr> 
    </tbody> 
   </table> 
  </div> 
  <div></div> 
  <div> 
   <a id="execute"></a> 
   <h3>Operation</h3> 
   <pre>if op == <a title="enumeration FPConvOp    {FPConvOp_CVT_FtoI, FPConvOp_CVT_ItoF, FPConvOp_MOV_FtoI, FPConvOp_MOV_ItoF , FPConvOp_CVT_FtoI_JS }" class="document-topic">FPConvOp_CVT_FtoI_JS</a> then
    <a title="function: CheckFPAdvSIMDEnabled64()" class="document-topic">CheckFPAdvSIMDEnabled64</a>();
else
    <a title="function: CheckFPEnabled64()" class="document-topic">CheckFPEnabled64</a>();

<a title="type FPCRType" class="document-topic">FPCRType</a> fpcr = FPCR[];
boolean merge = <a title="function: boolean IsMerging(FPCRType fpcr)" class="document-topic">IsMerging</a>(fpcr);
integer fsize = if op == <a title="enumeration FPConvOp    {FPConvOp_CVT_FtoI, FPConvOp_CVT_ItoF, FPConvOp_MOV_FtoI, FPConvOp_MOV_ItoF , FPConvOp_CVT_FtoI_JS }" class="document-topic">FPConvOp_CVT_ItoF</a> &amp;&amp; merge then 128 else fltsize;
bits(fsize) fltval;
bits(intsize) intval;

case op of
    when <a title="enumeration FPConvOp    {FPConvOp_CVT_FtoI, FPConvOp_CVT_ItoF, FPConvOp_MOV_FtoI, FPConvOp_MOV_ItoF , FPConvOp_CVT_FtoI_JS }" class="document-topic">FPConvOp_CVT_FtoI</a>
        fltval = <a title="accessor: bits(width) V[integer n, integer width]" class="document-topic">V</a>[n, fsize];
        intval = <a title="function: bits(M) FPToFixed(bits(N) op, integer fbits, boolean unsigned, FPCRType fpcr, FPRounding rounding, integer M)" class="document-topic">FPToFixed</a>(fltval, 0, unsigned, fpcr, rounding, intsize);
        <a title="accessor: X[integer n, integer width] = bits(width) value" class="document-topic">X</a>[d, intsize] = intval;
    when <a title="enumeration FPConvOp    {FPConvOp_CVT_FtoI, FPConvOp_CVT_ItoF, FPConvOp_MOV_FtoI, FPConvOp_MOV_ItoF , FPConvOp_CVT_FtoI_JS }" class="document-topic">FPConvOp_CVT_ItoF</a>
        intval = <a title="accessor: bits(width) X[integer n, integer width]" class="document-topic">X</a>[n, intsize];
        fltval = if merge then <a title="accessor: bits(width) V[integer n, integer width]" class="document-topic">V</a>[d, fsize] else <a title="function: bits(N) Zeros(integer N)" class="document-topic">Zeros</a>(fsize);
        <a title="accessor: Elem[bits(N) &amp;vector, integer e, integer size] = bits(size) value" class="document-topic">Elem</a>[fltval, 0, fltsize] = <a title="function: bits(N) FixedToFP(bits(M) op, integer fbits, boolean unsigned, FPCRType fpcr, FPRounding rounding, integer N)" class="document-topic">FixedToFP</a>(intval, 0, unsigned, fpcr, rounding, fltsize);
        <a title="accessor: V[integer n, integer width] = bits(width) value" class="document-topic">V</a>[d, fsize] = fltval;
    when <a title="enumeration FPConvOp    {FPConvOp_CVT_FtoI, FPConvOp_CVT_ItoF, FPConvOp_MOV_FtoI, FPConvOp_MOV_ItoF , FPConvOp_CVT_FtoI_JS }" class="document-topic">FPConvOp_MOV_FtoI</a>
        fltval = <a title="accessor: bits(width) Vpart[integer n, integer part, integer width]" class="document-topic">Vpart</a>[n,part,fsize];
        intval = <a title="function: bits(N) ZeroExtend(bits(M) x, integer N)" class="document-topic">ZeroExtend</a>(fltval, intsize);
        <a title="accessor: X[integer n, integer width] = bits(width) value" class="document-topic">X</a>[d, intsize] = intval;
    when <a title="enumeration FPConvOp    {FPConvOp_CVT_FtoI, FPConvOp_CVT_ItoF, FPConvOp_MOV_FtoI, FPConvOp_MOV_ItoF , FPConvOp_CVT_FtoI_JS }" class="document-topic">FPConvOp_MOV_ItoF</a>
        intval = <a title="accessor: bits(width) X[integer n, integer width]" class="document-topic">X</a>[n, intsize];
        fltval = intval&lt;fsize-1:0&gt;;
        <a title="accessor: Vpart[integer n, integer part, integer width] = bits(width) value" class="document-topic">Vpart</a>[d,part,fsize] = fltval;
    when <a title="enumeration FPConvOp    {FPConvOp_CVT_FtoI, FPConvOp_CVT_ItoF, FPConvOp_MOV_FtoI, FPConvOp_MOV_ItoF , FPConvOp_CVT_FtoI_JS }" class="document-topic">FPConvOp_CVT_FtoI_JS</a>
        bit z;
        fltval = <a title="accessor: bits(width) V[integer n, integer width]" class="document-topic">V</a>[n, fsize];
        (intval, z) = <a title="function: (bits(N), bit) FPToFixedJS(bits(M) op, FPCRType fpcr, boolean Is64, integer N)" class="document-topic">FPToFixedJS</a>(fltval, fpcr, TRUE, intsize);
        PSTATE.&lt;N,Z,C,V&gt; = '0':z:'00';
        <a title="accessor: X[integer n, integer width] = bits(width) value" class="document-topic">X</a>[d, intsize] = intval;</pre> 
  </div> 
  <h3>Operational information</h3> 
  <p>If FEAT_SME is implemented and the PE is in Streaming SVE mode, then any subsequent instruction which is dependent on the general-purpose register written by this instruction might be significantly delayed.</p>  
 </body>
</html>