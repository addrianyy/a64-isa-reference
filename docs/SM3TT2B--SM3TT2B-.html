<html>
 <head>  <link rel="stylesheet" href="../def-style.css"></head> 
 <body> 
  <h2>SM3TT2B</h2> 
  <p>SM3TT2B takes three 128-bit vectors from three source SIMD&amp;FP registers, and a 2-bit immediate index value, and returns a 128-bit result in the destination SIMD&amp;FP register. It performs a 32-bit majority function between the three 32-bit fields held in the upper three elements of the first source vector, and adds the resulting 32-bit value and the following three other 32-bit values:</p> 
  <ul> 
   <li>The bottom 32-bit element of the first source vector, Vd, that was used for the 32-bit majority function.</li> 
   <li>The 32-bit element held in the top 32 bits of the second source vector, Vn.</li> 
   <li>A 32-bit element indexed out of the third source vector, Vm.</li> 
  </ul> 
  <p>A three-way exclusive-OR is performed of the result of this addition, the result of the addition rotated left by 9, and the result of the addition rotated left by 17. The result of this exclusive-OR is returned as the top element of the returned result. The other elements of this result are taken from elements of the first source vector, with the element returned in bits&lt;63:32&gt; being rotated left by 19.</p> 
  <p>This instruction is implemented only when <em>FEAT_SM3</em> is implemented.</p> 
  <h3><a id="iclass_advsimd"></a>Advanced SIMD<span><br></br>(FEAT_SM3) </span></h3> 
  <p></p> 
  <div> 
   <table> 
    <thead> 
     <tr> 
      <td>31</td> 
      <td>30</td> 
      <td>29</td> 
      <td>28</td> 
      <td>27</td> 
      <td>26</td> 
      <td>25</td> 
      <td>24</td> 
      <td>23</td> 
      <td>22</td> 
      <td>21</td> 
      <td>20</td> 
      <td>19</td> 
      <td>18</td> 
      <td>17</td> 
      <td>16</td> 
      <td>15</td> 
      <td>14</td> 
      <td>13</td> 
      <td>12</td> 
      <td>11</td> 
      <td>10</td> 
      <td>9</td> 
      <td>8</td> 
      <td>7</td> 
      <td>6</td> 
      <td>5</td> 
      <td>4</td> 
      <td>3</td> 
      <td>2</td> 
      <td>1</td> 
      <td>0</td> 
     </tr> 
    </thead> 
    <tbody> 
     <tr> 
      <td>1</td> 
      <td>1</td> 
      <td>0</td> 
      <td>0</td> 
      <td>1</td> 
      <td>1</td> 
      <td>1</td> 
      <td>0</td> 
      <td>0</td> 
      <td>1</td> 
      <td>0</td> 
      <td colspan="5">Rm</td> 
      <td>1</td> 
      <td>0</td> 
      <td colspan="2">imm2</td> 
      <td>1</td> 
      <td>1</td> 
      <td colspan="5">Rn</td> 
      <td colspan="5">Rd</td> 
     </tr> 
    </tbody> 
   </table> 
  </div> 
  <div> 
   <h4></h4> 
   <a id="SM3TT2B_VVV_crypto3_imm2"></a> 
   <p>SM3TT2B <a title="SIMD&amp;FP source and destination register (field &quot;Rd&quot;)" class="document-topic">&lt;Vd&gt;</a>.4S, <a title="Second SIMD&amp;FP source register (field &quot;Rn&quot;)" class="document-topic">&lt;Vn&gt;</a>.4S, <a title="Third SIMD&amp;FP source register (field &quot;Rm&quot;)" class="document-topic">&lt;Vm&gt;</a>.S[<a title="32-bit element indexed out of <Vm> (field &quot;imm2&quot;)" class="document-topic">&lt;imm2&gt;</a>]</p> 
  </div> 
  <pre>if !<a title="function: boolean HaveSM3Ext()" class="document-topic">HaveSM3Ext</a>() then UNDEFINED;
integer d = <a title="function: integer UInt(bits(N) x)" class="document-topic">UInt</a>(Rd);
integer n = <a title="function: integer UInt(bits(N) x)" class="document-topic">UInt</a>(Rn);
integer m = <a title="function: integer UInt(bits(N) x)" class="document-topic">UInt</a>(Rm);
integer i = <a title="function: integer UInt(bits(N) x)" class="document-topic">UInt</a>(imm2);</pre> 
  <div></div> 
  <h3>Assembler Symbols</h3> 
  <div> 
   <table> 
    <colgroup> 
     <col></col> 
     <col></col> 
    </colgroup> 
    <tbody> 
     <tr> 
      <td>&lt;Vd&gt;</td> 
      <td><a id="sa_vd"></a> <p>Is the name of the SIMD&amp;FP source and destination register, encoded in the "Rd" field.</p> </td> 
     </tr> 
    </tbody> 
   </table> 
   <table> 
    <colgroup> 
     <col></col> 
     <col></col> 
    </colgroup> 
    <tbody> 
     <tr> 
      <td>&lt;Vn&gt;</td> 
      <td><a id="sa_vn"></a> <p>Is the name of the second SIMD&amp;FP source register, encoded in the "Rn" field.</p> </td> 
     </tr> 
    </tbody> 
   </table> 
   <table> 
    <colgroup> 
     <col></col> 
     <col></col> 
    </colgroup> 
    <tbody> 
     <tr> 
      <td>&lt;Vm&gt;</td> 
      <td><a id="sa_vm"></a> <p>Is the name of the third SIMD&amp;FP source register, encoded in the "Rm" field.</p> </td> 
     </tr> 
    </tbody> 
   </table> 
   <table> 
    <colgroup> 
     <col></col> 
     <col></col> 
    </colgroup> 
    <tbody> 
     <tr> 
      <td>&lt;imm2&gt;</td> 
      <td><a id="sa_imm2"></a> <p>Is a 32-bit element indexed out of &lt;Vm&gt;, encoded in "imm2".</p> </td> 
     </tr> 
    </tbody> 
   </table> 
  </div> 
  <div></div> 
  <div> 
   <a id="execute"></a> 
   <h3>Operation</h3> 
   <pre><a title="function: AArch64.CheckFPAdvSIMDEnabled()" class="document-topic">AArch64.CheckFPAdvSIMDEnabled</a>();

bits(128) Vm = <a title="accessor: bits(width) V[integer n, integer width]" class="document-topic">V</a>[m, 128];
bits(128) Vn = <a title="accessor: bits(width) V[integer n, integer width]" class="document-topic">V</a>[n, 128];
bits(128) Vd = <a title="accessor: bits(width) V[integer n, integer width]" class="document-topic">V</a>[d, 128];
bits(32) Wj;
bits(128) result; 
bits(32) TT2;

Wj = <a title="accessor: bits(size) Elem[bits(N) vector, integer e, integer size]" class="document-topic">Elem</a>[Vm,i,32];
TT2 = (Vd&lt;127:96&gt; AND Vd&lt;95:64&gt;) OR (NOT(Vd&lt;127:96&gt;) AND Vd&lt;63:32&gt;); 
TT2 = (TT2 + Vd&lt;31:0&gt; + Vn&lt;127:96&gt; + Wj)&lt;31:0&gt;;

result&lt;31:0&gt; = Vd&lt;63:32&gt;;
result&lt;63:32&gt; = <a title="function: bits(N) ROL(bits(N) x, integer shift)" class="document-topic">ROL</a>(Vd&lt;95:64&gt;,19); 
result&lt;95:64&gt; = Vd&lt;127:96&gt;; 
result&lt;127:96&gt; = TT2 EOR <a title="function: bits(N) ROL(bits(N) x, integer shift)" class="document-topic">ROL</a>(TT2,9) EOR <a title="function: bits(N) ROL(bits(N) x, integer shift)" class="document-topic">ROL</a>(TT2,17); 
<a title="accessor: V[integer n, integer width] = bits(width) value" class="document-topic">V</a>[d, 128] = result;</pre> 
  </div> 
  <h3>Operational information</h3> 
  <p>If PSTATE.DIT is 1:</p> 
  <ul> 
   <li>The execution time of this instruction is independent of: 
    <ul> 
     <li>The values of the data supplied in any of its registers.</li> 
     <li>The values of the NZCV flags.</li> 
    </ul></li> 
   <li>The response of this instruction to asynchronous exceptions does not vary based on: 
    <ul> 
     <li>The values of the data supplied in any of its registers.</li> 
     <li>The values of the NZCV flags.</li> 
    </ul></li> 
  </ul>  
 </body>
</html>